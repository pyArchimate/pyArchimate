<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyArchimate &mdash; pyArchimate 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../src.html" class="icon icon-home">
            pyArchimate
          </a>
              <div class="version">
                1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../pyArchimate.html">pyArchimate Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archiReader.html">Archimate tool file reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archimateReader.html">Archimate AMEFF file reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arisAMLReader.html">ARIS AML markup Language file reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archiWriter.html">Archimate Tool file writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archimateWriter.html">Archimate AMEFF file writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csvWriter.html">CSV file writer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../src.html">pyArchimate</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../src.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyArchimate</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyArchimate</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A library to create and manage Archimate models.</span>

<span class="sd">Author: Xavier Mayeur</span>
<span class="sd">Date: Aug 2022</span>
<span class="sd">Version 0.1</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">uuid4</span><span class="p">,</span> <span class="n">UUID</span>

<span class="kn">import</span> <span class="nn">lxml.etree</span> <span class="k">as</span> <span class="nn">et</span>
<span class="kn">import</span> <span class="nn">oyaml</span> <span class="k">as</span> <span class="nn">yaml</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.logger</span> <span class="kn">import</span> <span class="n">log</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">logger</span> <span class="kn">import</span> <span class="n">log</span>

<span class="fm">__mod__</span> <span class="o">=</span> <span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">__location__</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>

<span class="c1"># Dictionary of valid Archimate relationships</span>
<span class="n">allowed_relationships</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ARIS_type_map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">relationship_keys</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">archi_category</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">default_theme</span> <span class="o">=</span> <span class="s1">&#39;archi&#39;</span>


<div class="viewcode-block" id="Writers">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Writers">[docs]</a>
<span class="k">class</span> <span class="nc">Writers</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumeration for Writers drivers</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">archi</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">archimate</span> <span class="o">=</span> <span class="mi">2</span></div>



<div class="viewcode-block" id="Readers">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Readers">[docs]</a>
<span class="k">class</span> <span class="nc">Readers</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumaration for Readers drivers</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">archi</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">aris</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">archimate</span> <span class="o">=</span> <span class="mi">2</span></div>



<div class="viewcode-block" id="AccessType">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.AccessType">[docs]</a>
<span class="k">class</span> <span class="nc">AccessType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumeration of Access Relationship types</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Access</span> <span class="o">=</span> <span class="s1">&#39;Access&#39;</span>
    <span class="n">Read</span> <span class="o">=</span> <span class="s1">&#39;Read&#39;</span>
    <span class="n">Write</span> <span class="o">=</span> <span class="s1">&#39;Write&#39;</span>
    <span class="n">ReadWrite</span> <span class="o">=</span> <span class="s1">&#39;ReadWrite&#39;</span></div>



<div class="viewcode-block" id="TextPosition">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.TextPosition">[docs]</a>
<span class="k">class</span> <span class="nc">TextPosition</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumaration for Text vertical position</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Top</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
    <span class="n">Middle</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
    <span class="n">Bottom</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span></div>



<div class="viewcode-block" id="TextAlignment">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.TextAlignment">[docs]</a>
<span class="k">class</span> <span class="nc">TextAlignment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumeration for text horizontal position</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Left</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
    <span class="n">Center</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
    <span class="n">Right</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span></div>



<span class="n">influenceStrength</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;++&#39;</span><span class="p">:</span> <span class="s1">&#39;++&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">},</span>


<div class="viewcode-block" id="ArchiType">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.ArchiType">[docs]</a>
<span class="k">class</span> <span class="nc">ArchiType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumeration of Archimate Element &amp; Relationships types</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Business Layer</span>
    <span class="n">BusinessActor</span> <span class="o">=</span> <span class="s2">&quot;BusinessActor&quot;</span>
    <span class="n">BusinessRole</span> <span class="o">=</span> <span class="s2">&quot;BusinessRole&quot;</span>
    <span class="n">BusinessCollaboration</span> <span class="o">=</span> <span class="s2">&quot;BusinessCollaboration&quot;</span>
    <span class="n">BusinessInterface</span> <span class="o">=</span> <span class="s2">&quot;BusinessInterface&quot;</span>
    <span class="n">BusinessProcess</span> <span class="o">=</span> <span class="s2">&quot;BusinessProcess&quot;</span>
    <span class="n">BusinessFunction</span> <span class="o">=</span> <span class="s2">&quot;BusinessFunction&quot;</span>
    <span class="n">BusinessInteraction</span> <span class="o">=</span> <span class="s2">&quot;BusinessInteraction&quot;</span>
    <span class="n">BusinessEvent</span> <span class="o">=</span> <span class="s2">&quot;BusinessEvent&quot;</span>
    <span class="n">BusinessService</span> <span class="o">=</span> <span class="s2">&quot;BusinessService&quot;</span>
    <span class="n">BusinessObject</span> <span class="o">=</span> <span class="s2">&quot;BusinessObject&quot;</span>
    <span class="n">Contract</span> <span class="o">=</span> <span class="s2">&quot;Contract&quot;</span>
    <span class="n">Representation</span> <span class="o">=</span> <span class="s2">&quot;Representation&quot;</span>
    <span class="n">Product</span> <span class="o">=</span> <span class="s2">&quot;Product&quot;</span>

    <span class="c1"># Application Layer</span>

    <span class="n">ApplicationComponent</span> <span class="o">=</span> <span class="s2">&quot;ApplicationComponent&quot;</span>
    <span class="n">ApplicationInterface</span> <span class="o">=</span> <span class="s2">&quot;ApplicationInterface&quot;</span>
    <span class="n">ApplicationCollaboration</span> <span class="o">=</span> <span class="s2">&quot;ApplicationCollaboration&quot;</span>
    <span class="n">ApplicationFunction</span> <span class="o">=</span> <span class="s2">&quot;ApplicationFunction&quot;</span>
    <span class="n">ApplicationProcess</span> <span class="o">=</span> <span class="s2">&quot;ApplicationProcess&quot;</span>
    <span class="n">ApplicationEvent</span> <span class="o">=</span> <span class="s2">&quot;ApplicationEvent&quot;</span>
    <span class="n">ApplicationService</span> <span class="o">=</span> <span class="s2">&quot;ApplicationService&quot;</span>
    <span class="n">DataObject</span> <span class="o">=</span> <span class="s2">&quot;DataObject&quot;</span>

    <span class="c1"># Technology layer</span>

    <span class="n">Node</span> <span class="o">=</span> <span class="s2">&quot;Node&quot;</span>
    <span class="n">Device</span> <span class="o">=</span> <span class="s2">&quot;Device&quot;</span>
    <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;Path&quot;</span>
    <span class="n">CommunicationNetwork</span> <span class="o">=</span> <span class="s2">&quot;CommunicationNetwork&quot;</span>
    <span class="n">SystemSoftware</span> <span class="o">=</span> <span class="s2">&quot;SystemSoftware&quot;</span>
    <span class="n">TechnologyCollaboration</span> <span class="o">=</span> <span class="s2">&quot;TechnologyCollaboration&quot;</span>
    <span class="n">TechnologyInterface</span> <span class="o">=</span> <span class="s2">&quot;TechnologyInterface&quot;</span>
    <span class="n">TechnologyFunction</span> <span class="o">=</span> <span class="s2">&quot;TechnologyFunction&quot;</span>
    <span class="n">TechnologyProcess</span> <span class="o">=</span> <span class="s2">&quot;TechnologyProcess&quot;</span>
    <span class="n">TechnologyInteraction</span> <span class="o">=</span> <span class="s2">&quot;TechnologyInteraction&quot;</span>
    <span class="n">TechnologyEvent</span> <span class="o">=</span> <span class="s2">&quot;TechnologyEvent&quot;</span>
    <span class="n">TechnologyService</span> <span class="o">=</span> <span class="s2">&quot;TechnologyService&quot;</span>
    <span class="n">Artifact</span> <span class="o">=</span> <span class="s2">&quot;Artifact&quot;</span>

    <span class="c1"># Physical elements</span>

    <span class="n">Equipment</span> <span class="o">=</span> <span class="s2">&quot;Equipment&quot;</span>
    <span class="n">Facility</span> <span class="o">=</span> <span class="s2">&quot;Facility&quot;</span>
    <span class="n">DistributionNetwork</span> <span class="o">=</span> <span class="s2">&quot;DistributionNetwork&quot;</span>
    <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Material&quot;</span>

    <span class="c1">#  Motivation</span>

    <span class="n">Stakeholder</span> <span class="o">=</span> <span class="s2">&quot;Stakeholder&quot;</span>
    <span class="n">Driver</span> <span class="o">=</span> <span class="s2">&quot;Driver&quot;</span>
    <span class="n">Assessment</span> <span class="o">=</span> <span class="s2">&quot;Assessment&quot;</span>
    <span class="n">Goal</span> <span class="o">=</span> <span class="s2">&quot;Goal&quot;</span>
    <span class="n">Outcome</span> <span class="o">=</span> <span class="s2">&quot;Outcome&quot;</span>
    <span class="n">Principle</span> <span class="o">=</span> <span class="s2">&quot;Principle&quot;</span>
    <span class="n">Requirement</span> <span class="o">=</span> <span class="s2">&quot;Requirement&quot;</span>
    <span class="n">Constraint</span> <span class="o">=</span> <span class="s2">&quot;Constraint&quot;</span>
    <span class="n">Meaning</span> <span class="o">=</span> <span class="s2">&quot;Meaning&quot;</span>
    <span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Value&quot;</span>

    <span class="c1"># Strategy</span>

    <span class="n">Resource</span> <span class="o">=</span> <span class="s2">&quot;Resource&quot;</span>
    <span class="n">Capability</span> <span class="o">=</span> <span class="s2">&quot;Capability&quot;</span>
    <span class="n">CourseOfAction</span> <span class="o">=</span> <span class="s2">&quot;CourseOfAction&quot;</span>
    <span class="n">ValueStream</span> <span class="o">=</span> <span class="s2">&quot;ValueStream&quot;</span>

    <span class="c1"># Implementation &amp; Migration</span>

    <span class="n">WorkPackage</span> <span class="o">=</span> <span class="s2">&quot;WorkPackage&quot;</span>
    <span class="n">Deliverable</span> <span class="o">=</span> <span class="s2">&quot;Deliverable&quot;</span>
    <span class="n">ImplementationEvent</span> <span class="o">=</span> <span class="s2">&quot;ImplementationEvent&quot;</span>
    <span class="n">Plateau</span> <span class="o">=</span> <span class="s2">&quot;Plateau&quot;</span>
    <span class="n">Gap</span> <span class="o">=</span> <span class="s2">&quot;Gap&quot;</span>

    <span class="c1"># Other</span>

    <span class="n">Grouping</span> <span class="o">=</span> <span class="s2">&quot;Grouping&quot;</span>
    <span class="n">Location</span> <span class="o">=</span> <span class="s2">&quot;Location&quot;</span>

    <span class="c1"># Junction</span>

    <span class="n">Junction</span> <span class="o">=</span> <span class="s2">&quot;Junction&quot;</span>
    <span class="n">OrJunction</span> <span class="o">=</span> <span class="s2">&quot;OrJunction&quot;</span>
    <span class="n">AndJunction</span> <span class="o">=</span> <span class="s2">&quot;AndJunction&quot;</span>

    <span class="c1"># Relationships</span>

    <span class="n">Association</span> <span class="o">=</span> <span class="s2">&quot;Association&quot;</span>
    <span class="n">Assignment</span> <span class="o">=</span> <span class="s2">&quot;Assignment&quot;</span>
    <span class="n">Realization</span> <span class="o">=</span> <span class="s2">&quot;Realization&quot;</span>
    <span class="n">Serving</span> <span class="o">=</span> <span class="s2">&quot;Serving&quot;</span>
    <span class="n">Composition</span> <span class="o">=</span> <span class="s2">&quot;Composition&quot;</span>
    <span class="n">Aggregation</span> <span class="o">=</span> <span class="s2">&quot;Aggregation&quot;</span>
    <span class="n">Access</span> <span class="o">=</span> <span class="s2">&quot;Access&quot;</span>
    <span class="n">Influence</span> <span class="o">=</span> <span class="s2">&quot;Influence&quot;</span>
    <span class="n">Triggering</span> <span class="o">=</span> <span class="s2">&quot;Triggering&quot;</span>
    <span class="n">Flow</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span>
    <span class="n">Specialization</span> <span class="o">=</span> <span class="s2">&quot;Specialization&quot;</span>

    <span class="c1"># Special</span>
    <span class="n">View</span> <span class="o">=</span> <span class="s2">&quot;View&quot;</span></div>



<div class="viewcode-block" id="ArchimateRelationshipError">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.ArchimateRelationshipError">[docs]</a>
<span class="k">class</span> <span class="nc">ArchimateRelationshipError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>



<div class="viewcode-block" id="ArchimateConceptTypeError">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.ArchimateConceptTypeError">[docs]</a>
<span class="k">class</span> <span class="nc">ArchimateConceptTypeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>



<span class="k">def</span> <span class="nf">_is_valid_uuid</span><span class="p">(</span><span class="n">uuid_to_test</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if uuid_to_test is a valid UUID.</span>

<span class="sd">    :param uuid_to_test: uuid string</span>
<span class="sd">    :param version: {1, 2, 3, 4}</span>
<span class="sd">    :return: True if uuid_to_test is a valid UUID, otherwise `False`.</span>
<span class="sd">    :rtype: bool</span>

<span class="sd">     Examples</span>
<span class="sd">    --------</span>
<span class="sd">    is_valid_uuid(&#39;c9bf9e57-1685-4c89-bafb-ff5af830be8a&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    is_valid_uuid(&#39;c9bf9e58&#39;)</span>
<span class="sd">    False</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">uuid_obj</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">uuid_to_test</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid_obj</span><span class="p">)</span> <span class="o">==</span> <span class="n">uuid_to_test</span>


<div class="viewcode-block" id="set_id">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.set_id">[docs]</a>
<span class="k">def</span> <span class="nf">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to create an identifier if none exists</span>

<span class="sd">    :param uuid: a uuid</span>
<span class="sd">    :cat uuid: str</span>
<span class="sd">    :return: a formatted identifier</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span> <span class="k">if</span> <span class="p">(</span><span class="n">uuid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">uuid</span>
    <span class="k">if</span> <span class="n">_is_valid_uuid</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="n">_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_id</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;id-&#39;</span><span class="p">:</span>
            <span class="n">_id</span> <span class="o">=</span> <span class="s1">&#39;id-&#39;</span> <span class="o">+</span> <span class="n">_id</span>
    <span class="k">return</span> <span class="n">_id</span></div>



<div class="viewcode-block" id="default_color">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.default_color">[docs]</a>
<span class="k">def</span> <span class="nf">default_color</span><span class="p">(</span><span class="n">elem_type</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">default_theme</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the default color of a Node, according to its type</span>

<span class="sd">    :param elem_type:       archimate element type</span>
<span class="sd">    :type elem_type: str</span>
<span class="sd">    :param theme:  &#39;archi&#39; or &#39;aris&#39; color theme - default = &#39;archi&#39;</span>
<span class="sd">    :type theme: str</span>
<span class="sd">    :return: #Hex color str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;#F5DEAA&#39;</span><span class="p">,</span> <span class="s1">&#39;business&#39;</span><span class="p">:</span> <span class="s2">&quot;#FFFFB5&quot;</span><span class="p">,</span> <span class="s1">&#39;application&#39;</span><span class="p">:</span> <span class="s2">&quot;#B5FFFF&quot;</span><span class="p">,</span> <span class="s1">&#39;technology&#39;</span><span class="p">:</span> <span class="s2">&quot;#C9E7B7&quot;</span><span class="p">,</span>
                      <span class="s1">&#39;physical&#39;</span><span class="p">:</span> <span class="s2">&quot;#C9E7B7&quot;</span><span class="p">,</span> <span class="s1">&#39;migration&#39;</span><span class="p">:</span> <span class="s2">&quot;#FFE0E0&quot;</span><span class="p">,</span> <span class="s1">&#39;motivation&#39;</span><span class="p">:</span> <span class="s2">&quot;#CCCCFF&quot;</span><span class="p">,</span>
                      <span class="s1">&#39;relationship&#39;</span><span class="p">:</span> <span class="s2">&quot;#DDDDDD&quot;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;junction&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">}</span>
    <span class="n">aris_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;#D38300&#39;</span><span class="p">,</span> <span class="s1">&#39;business&#39;</span><span class="p">:</span> <span class="s2">&quot;#F5C800&quot;</span><span class="p">,</span> <span class="s1">&#39;application&#39;</span><span class="p">:</span> <span class="s2">&quot;#00A0FF&quot;</span><span class="p">,</span> <span class="s1">&#39;technology&#39;</span><span class="p">:</span> <span class="s2">&quot;#6BA50E&quot;</span><span class="p">,</span>
                   <span class="s1">&#39;physical&#39;</span><span class="p">:</span> <span class="s2">&quot;#6BA50E&quot;</span><span class="p">,</span> <span class="s1">&#39;migration&#39;</span><span class="p">:</span> <span class="s2">&quot;#FFE0E0&quot;</span><span class="p">,</span> <span class="s1">&#39;motivation&#39;</span><span class="p">:</span> <span class="s2">&quot;#F099FF&quot;</span><span class="p">,</span>
                   <span class="s1">&#39;relationship&#39;</span><span class="p">:</span> <span class="s2">&quot;#DDDDDD&quot;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;junction&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">archi_category</span><span class="p">:</span>
        <span class="n">cat</span> <span class="o">=</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">elem_type</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s1">&#39;archi&#39;</span> <span class="ow">or</span> <span class="n">theme</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default_colors</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s1">&#39;aris&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">aris_colors</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">theme</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default_colors</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span></div>



<div class="viewcode-block" id="check_valid_relationship">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.check_valid_relationship">[docs]</a>
<span class="k">def</span> <span class="nf">check_valid_relationship</span><span class="p">(</span><span class="n">rel_type</span><span class="p">,</span> <span class="n">source_type</span><span class="p">,</span> <span class="n">target_type</span><span class="p">,</span> <span class="n">raise_flg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if a relationship is used according to Archimate language or raise an exception</span>

<span class="sd">    :param rel_type:        relationship type</span>
<span class="sd">    :type rel_type: str</span>
<span class="sd">    :param source_type:     source concept type</span>
<span class="sd">    :type source_type: str</span>
<span class="sd">    :param target_type:     target concept type</span>
<span class="sd">    :type target_type: str</span>
<span class="sd">    :param raise_flg: Throw an exception instead of logging an error</span>

<span class="sd">    # :raises ArchimateConceptTypeError: Exception raised on invalid object Archimate type</span>
<span class="sd">    # :raises ArchimateRelationshipError: Exception raised on invalid relationship between the source and target parent elements</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">)</span> <span class="ow">or</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">rel_type</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Relationship Concept type &#39;</span><span class="si">{</span><span class="n">rel_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raise_flg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Relationship Concept type &#39;</span><span class="si">{</span><span class="n">rel_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">source_type</span><span class="p">):</span>  <span class="c1"># or archi_category[source_type] == &#39;Relationship&#39;:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Source Concept type &#39;</span><span class="si">{</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raise_flg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Source Concept type &#39;</span><span class="si">{</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">target_type</span><span class="p">):</span>  <span class="c1"># or archi_category[target_type] == &#39;Relationship&#39;:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Target Concept type &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raise_flg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Target Concept type &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">source_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
        <span class="n">source_type</span> <span class="o">=</span> <span class="s2">&quot;Relationship&quot;</span>
    <span class="k">if</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">target_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
        <span class="n">target_type</span> <span class="o">=</span> <span class="s2">&quot;Relationship&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;Junction&#39;</span> <span class="ow">in</span> <span class="n">rel_type</span><span class="p">:</span>
        <span class="n">rel_type</span> <span class="o">=</span> <span class="s1">&#39;Junction&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;Junction&#39;</span> <span class="ow">in</span> <span class="n">source_type</span><span class="p">:</span>
        <span class="n">source_type</span> <span class="o">=</span> <span class="s1">&#39;Junction&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;Junction&#39;</span> <span class="ow">in</span> <span class="n">target_type</span><span class="p">:</span>
        <span class="n">target_type</span> <span class="o">=</span> <span class="s1">&#39;Junction&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">relationship_keys</span><span class="p">[</span><span class="n">rel_type</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_relationships</span><span class="p">[</span><span class="n">source_type</span><span class="p">][</span><span class="n">target_type</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">ArchimateRelationshipError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Relationship type &#39;</span><span class="si">{</span><span class="n">rel_type</span><span class="si">}</span><span class="s2">&#39; from &#39;</span><span class="si">{</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raise_flg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ArchimateRelationshipError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Relationship type &#39;</span><span class="si">{</span><span class="n">rel_type</span><span class="si">}</span><span class="s2">&#39; from &#39;</span><span class="si">{</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">))</span></div>



<div class="viewcode-block" id="get_default_rel_type">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.get_default_rel_type">[docs]</a>
<span class="k">def</span> <span class="nf">get_default_rel_type</span><span class="p">(</span><span class="n">source_type</span><span class="p">,</span> <span class="n">target_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default valid relationship between two element types</span>

<span class="sd">    :param source_type:     source element type</span>
<span class="sd">    :type source_type: str</span>
<span class="sd">    :param target_type:     target element type</span>
<span class="sd">    :type target_type: str</span>
<span class="sd">    :return: default relationship type</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">source_type</span><span class="p">)</span> <span class="ow">or</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">source_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Source Concept type &#39;</span><span class="si">{</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">target_type</span><span class="p">)</span> <span class="ow">or</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">target_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Archimate Target Concept type &#39;</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">rels</span> <span class="o">=</span> <span class="n">allowed_relationships</span><span class="p">[</span><span class="n">source_type</span><span class="p">][</span><span class="n">target_type</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;v&#39;</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;v&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">rels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">relationship_keys</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>



<div class="viewcode-block" id="Point">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Point">[docs]</a>
<span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple class to manage x, y coordinates of a point</span>
<span class="sd">    x: x-coordinate</span>
<span class="sd">    y: y-coordinate</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        x-coordinate getter</span>
<span class="sd">        :return: x-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@x</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        x-coordinate setter</span>
<span class="sd">        Set x-coordinate to zero if negative value is passed</span>

<span class="sd">        :param val: new x-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        y-coordinate getter</span>
<span class="sd">        :return: y-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@y</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        y-coordinate setter</span>
<span class="sd">        Set y-coordinate to zero if negative value is passed</span>

<span class="sd">        :param val: new x-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">val</span></div>



<div class="viewcode-block" id="Position">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Position">[docs]</a>
<span class="k">class</span> <span class="nc">Position</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to manage positional parameters of a node with respect to to another one</span>
<span class="sd">        dx: horizontal distance between the two nodes centres</span>
<span class="sd">        dy: vertical distance between the two node centres</span>
<span class="sd">        gap_x: horizontal distance between the adjacent vertical edges of the two nodes</span>
<span class="sd">        gap_y: vertical distance between the adjacent horizontal edges of the two nodes</span>
<span class="sd">        angle the angle of the imaginary line connecting the two node&#39;s centers</span>
<span class="sd">        orientation: one of the letter L(eft), R(ight), T(op), B(ottom) giving the position of the other node</span>
<span class="sd">        with respect to this node. An exclamation character &#39;!&#39; means that the adjacent edges</span>
<span class="sd">        are overlapping</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the distance between the two nodes</span>
<span class="sd">        :return: absolute value of the distance</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="RGBA">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.RGBA">[docs]</a>
<span class="k">class</span> <span class="nc">RGBA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage RGB/hex color and alpha (opacity) channels</span>

<span class="sd">    :param r: red channel color intensity 0-255</span>
<span class="sd">    :param g: green channel color intensity 0-255</span>
<span class="sd">    :param b: blue channel color intensity 0-255</span>
<span class="sd">    :param a: alpha channel color intensity 0-100</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get #RGB hex string</span>

<span class="sd">        :return: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_color</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">return</span> <span class="s1">&#39;#</span><span class="si">{0:02x}{1:02x}{2:02x}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_string</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set RGB color from #HEX string</span>

<span class="sd">        :param color_string:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">color_string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">5</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span></div>



<div class="viewcode-block" id="Font">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Font">[docs]</a>
<span class="k">class</span> <span class="nc">Font</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage font attributes</span>

<span class="sd">    :param name: Font name</span>
<span class="sd">    :param size: Font size</span>
<span class="sd">    :param color: RGBA-class font color</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">RGBA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">color</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get #Hex font color</span>

<span class="sd">        :return:  #Hex color string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">color</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set #Hex color</span>

<span class="sd">        :param color_string:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">color_string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBA</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="mi">16</span><span class="p">),</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">16</span><span class="p">),</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">color_string</span><span class="p">[</span><span class="mi">5</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Element">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element">[docs]</a>
<span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage Element artifacts</span>

<span class="sd">    :param name: Name of the element</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param elem_type: Archimate concept type of element</span>
<span class="sd">    :type elem_type: str</span>
<span class="sd">    :param uuid: element identifier</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param desc: description of the element</span>
<span class="sd">    :type desc: str</span>
<span class="sd">    :param folder: folder path in which element should be referred to (e.g. /Application/BE)</span>
<span class="sd">    :type folder: str</span>
<span class="sd">    :param parent: reference to the parent Model object</span>
<span class="sd">    :type parent: Model</span>

<span class="sd">    :raises ArchimateConceptTypeError: Exception raised on elem_type or parent tyme error</span>

<span class="sd">    :return: Element object</span>
<span class="sd">    :rtype: Element</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># Check validity of arguments according to Archimate standard</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ArchiType</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Element type &#39;</span><span class="si">{</span><span class="n">elem_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">elem_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Element type &#39;</span><span class="si">{</span><span class="n">elem_type</span><span class="si">}</span><span class="s2">&#39; cannot be a Relationship type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Element class parent should be a class Model instance!&#39;</span><span class="p">)</span>

        <span class="c1"># Attribute and data structure initialization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">elem_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">junction_type</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Element.delete">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.delete">[docs]</a>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the current element from the parent model</span>
<span class="sd">        Note: it does not delete the instance itself but it remove the data from the model</span>

<span class="sd">        It also deletes all relationships that have this element as source or target and</span>
<span class="sd">        it deletes all visual nodes referring to this element (and conns) from views</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>

        <span class="c1"># remove nodes used in views referring to this element</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">n_id</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">uuid</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">_id</span><span class="p">:</span>
                <span class="n">n</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">n</span>

        <span class="c1"># remove relationships from ot to this element</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">_id</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">_id</span><span class="p">:</span>
                <span class="n">r</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">r</span>

        <span class="c1"># remove this element&#39;s id from parent&#39;s dictionaries</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the identifier of this element</span>

<span class="sd">        :return:    Identifier str</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Archimate concept type of this element</span>

<span class="sd">        :return:    type str</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>

    <span class="nd">@type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert this element to a new Archimate concept type</span>
<span class="sd">        Note: this is potentially dangerous as existing relationships may become invalid</span>
<span class="sd">        No check if performed on the relationship validity afet conversion</span>

<span class="sd">        :param value:</span>
<span class="sd">        :type value: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi_category</span> <span class="ow">or</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid Archimate element type&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all element properties as a  dictionary</span>

<span class="sd">        :return: properties</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span>

<div class="viewcode-block" id="Element.prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.prop">[docs]</a>
    <span class="k">def</span> <span class="nf">prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get or set an element&#39;s property</span>

<span class="sd">        :param key:     Property key</span>
<span class="sd">        :type key: str</span>
<span class="sd">        :param value:   Property value</span>
<span class="sd">        :type value: str</span>
<span class="sd">        :return: an existing element property value str if &#39;value&#39; argument is None</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Element.remove_prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.remove_prop">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove an element property</span>

<span class="sd">        :param key:</span>
<span class="sd">        :type key: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>


<div class="viewcode-block" id="Element.merge">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.merge">[docs]</a>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge_props</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to merge another element of the same type with this element</span>

<span class="sd">        :param elem:        the element to merge</span>
<span class="sd">        :type elem: Element</span>
<span class="sd">        :param merge_props: flag to merge or not the properties</span>
<span class="sd">        :type merge_props: bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if merged elem is of the same type or raise an exception</span>
        <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Merged element has not the same type as target&#39;</span><span class="p">)</span>

        <span class="c1"># merge elem into the current one</span>
        <span class="k">if</span> <span class="n">merge_props</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

            <span class="c1"># merge (concatenate) element description</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">desc</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">elem</span><span class="o">.</span><span class="n">desc</span>

        <span class="c1"># Re-assign othe element related node references to this element (merge target)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span><span class="p">]:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>

        <span class="c1"># Re-assign other element inboud and outbound relationship references to this element</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span><span class="p">)):</span>
            <span class="n">r</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span><span class="p">)):</span>
            <span class="n">r</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="c1"># finally delete the merged element</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></div>


<div class="viewcode-block" id="Element.in_rels">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.in_rels">[docs]</a>
    <span class="k">def</span> <span class="nf">in_rels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get a list of the inbound relationships</span>

<span class="sd">        :param rel_type: relationship type to filter</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">        :return:         [Relationship]</span>
<span class="sd">        :rtype: list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
                    <span class="ow">and</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span><span class="p">)</span>
                                                   <span class="p">)</span></div>


<div class="viewcode-block" id="Element.out_rels">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.out_rels">[docs]</a>
    <span class="k">def</span> <span class="nf">out_rels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get a list of the outbound relationships</span>

<span class="sd">        :param rel_type: relationship type to filter</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">        :return:         [Relationship]</span>
<span class="sd">        :rtype: list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
                    <span class="ow">and</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span><span class="p">)</span>
                                                   <span class="p">)</span></div>


<div class="viewcode-block" id="Element.rels">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.rels">[docs]</a>
    <span class="k">def</span> <span class="nf">rels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get a list of the inbound and outbound relationships</span>

<span class="sd">        :param rel_type: relationship type to filter</span>
<span class="sd">        :type rel_type: str</span>

<span class="sd">        :return:         [Relationship]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
                    <span class="ow">or</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
                                                   <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
                    <span class="ow">and</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span><span class="p">)</span>
                                                   <span class="p">)</span></div>


<div class="viewcode-block" id="Element.remove_folder">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Element.remove_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove this element from the given folder path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="kc">None</span></div>
</div>



<div class="viewcode-block" id="Relationship">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Relationship">[docs]</a>
<span class="k">class</span> <span class="nc">Relationship</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage the relationship between two elements of the model</span>

<span class="sd">    :param rel_type:        Archimate relationship type</span>
<span class="sd">    :type rel_type: str</span>
<span class="sd">    :param source:          element source either an element identifier, or an element object</span>
<span class="sd">    :type source: [str|Element]</span>
<span class="sd">    :param target:          element target either an element identifier, or an element object</span>
<span class="sd">    :type target: [str|Element]</span>
<span class="sd">    :param uuid:            identifier of the relationship</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param name:            optional name of the relationship</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param access_type:     optional parameter for access relationship (&#39;Read&#39;, &#39;ReadWrite&#39;, &#39;Write&#39;, &#39;Access&#39;)</span>
<span class="sd">    :type access_type: str</span>
<span class="sd">    :param influence_strength: optional influence strength (1-10, &#39;+&#39;, &#39;-&#39;)parameter for influence relationship</span>
<span class="sd">    :type influence_strength: str</span>
<span class="sd">    :param desc:             description of the relationship</span>
<span class="sd">    :type desc: str</span>
<span class="sd">    :param is_directed:      boolean flag for association relationship</span>
<span class="sd">    :type is_directed: bool</span>
<span class="sd">    :param parent:           parent Model object</span>
<span class="sd">    :type parent: Model</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">access_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">influence_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Relationship class parent should be a class Model instance!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="c1"># get source identifier as reference</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;source&#39; argument is not an instance of &#39;Element or Relationship&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid source reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># get target identifier</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;target&#39; argument is not an instance of &#39;Element/Relationship&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid target reference &quot;</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">rel_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_access_type</span> <span class="o">=</span> <span class="n">access_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_influence_strength</span> <span class="o">=</span> <span class="n">influence_strength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directed</span> <span class="o">=</span> <span class="n">is_directed</span>

        <span class="c1"># check relationship validity (it also tests concept type validity) or raise exception</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="n">src_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">src_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="n">dst_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dst_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>

        <span class="n">check_valid_relationship</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">src_type</span><span class="p">,</span> <span class="n">dst_type</span><span class="p">)</span>

        <span class="c1"># Add the new relationship object in model&#39;s dictionaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

<div class="viewcode-block" id="Relationship.delete">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Relationship.delete">[docs]</a>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete this relationship from the model structure</span>
<span class="sd">        Also take care to remove visual conns from the views</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>
        <span class="c1"># remove related conns</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">_id</span><span class="p">:</span>
                <span class="n">c</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">c</span>
        <span class="c1"># remove from parent dictionaries</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get this relationship identifier</span>

<span class="sd">        :return: Identifier</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the source object</span>

<span class="sd">        :return: Source object</span>
<span class="sd">        :rtype: [Element | None]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span>
            <span class="n">_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@source</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the reference to a new source object</span>

<span class="sd">        :param src: an Element identifier or an Element object</span>
<span class="sd">        :type src: [str | Element]</span>
<span class="sd">        :raises ArchimateConceptTypeError: wrong type exception</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">src</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s2">&quot;&#39;source&#39; argument is not an instance of &#39;Element&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the target object</span>

<span class="sd">        :return: Element object</span>
<span class="sd">        :rtype: Element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">elems_dict</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rels_dict</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@target</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the reference to a new target object</span>

<span class="sd">        :param dst: an Element identifier or an Element object</span>
<span class="sd">        :type dst: [str | Element]</span>
<span class="sd">        :raises ArchimateConceptTypeError: wrong type exception</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">dst</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s2">&quot;&#39;target&#39; argument is not an instance of &#39;Element&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">dst</span><span class="o">.</span><span class="n">uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Archimate type of the relationship</span>

<span class="sd">        :return: Archimate type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>

    <span class="nd">@type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new type for the relationship</span>

<span class="sd">        :param new_type:</span>
<span class="sd">        :type new_type: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi_category</span> <span class="ow">or</span> <span class="n">archi_category</span><span class="p">[</span><span class="n">new_type</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Relationship&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid Archimate relationship type&#39;</span><span class="p">)</span>
        <span class="c1"># Raise an exception is the new relationship type is not compatible with the source &amp; target ones</span>
        <span class="n">check_valid_relationship</span><span class="p">(</span><span class="n">new_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">new_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the properties of this relationship</span>

<span class="sd">        :return: properties</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span>

<div class="viewcode-block" id="Relationship.prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Relationship.prop">[docs]</a>
    <span class="k">def</span> <span class="nf">prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set a property given by its key if a value is provided</span>
<span class="sd">        or to return of value of a property if the value is None</span>

<span class="sd">        :param key:</span>
<span class="sd">        :type key: str</span>
<span class="sd">        :param value:</span>
<span class="sd">        :type value: str</span>
<span class="sd">        :return:   value of the property defined by the key or None</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Relationship.remove_prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Relationship.remove_prop">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Methode to remove a property by key</span>

<span class="sd">        :param key:</span>
<span class="sd">        :type key: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">access_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the access type of an Access relationship</span>

<span class="sd">        :return: type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_type</span>

    <span class="nd">@access_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">access_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the access type of an Access relationship</span>

<span class="sd">        :param val:</span>
<span class="sd">        :type val: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_access_type</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Access</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_access_type</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the direction of an Association relationship</span>

<span class="sd">        :return: direction flag</span>
<span class="sd">        :rtype: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directed</span>

    <span class="nd">@is_directed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the direction of an Association relationship</span>

<span class="sd">        :param val:</span>
<span class="sd">        :type val: bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Association</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directed</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">val</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">influence_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the influence strength of an Influence relationship</span>

<span class="sd">        :return: influence strength</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_influence_strength</span>

    <span class="nd">@influence_strength</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">influence_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the influence strength of an Influence relationship</span>
<span class="sd">        [0-10 | &#39;+&#39; | &#39;++&#39; | &#39;-&#39; | &#39;--&#39;]</span>

<span class="sd">        :param strength: strength value</span>
<span class="sd">        :type strength: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Influence</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_influence_strength</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span>

<div class="viewcode-block" id="Relationship.remove_folder">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Relationship.remove_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove this element from the given folder path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="kc">None</span></div>
</div>



<div class="viewcode-block" id="Node">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node">[docs]</a>
<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage Nodes</span>
<span class="sd">    A Node is a visual object representing an Element concept in a View</span>

<span class="sd">    :param ref:     Identifier of the related Element or an Element object</span>
<span class="sd">    :type ref: [str | Element]</span>
<span class="sd">    :param x:       top-left absolute x coordinate of the node in the view</span>
<span class="sd">    :type x: int</span>
<span class="sd">    :param y:       top-left absolute y coordinate of the node in the view</span>
<span class="sd">    :type y: int</span>
<span class="sd">    :param w:       width of the node</span>
<span class="sd">    :type w: int</span>
<span class="sd">    :param h:       height of the node</span>
<span class="sd">    :type h: int</span>
<span class="sd">    :param uuid:    Node identifier</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param node_type: Node type [&#39;Element&#39; | &#39;Label&#39; | &#39;Container&#39;]</span>
<span class="sd">    :type node_type: str</span>
<span class="sd">    :param label:   Label text if node type is not &#39;Element&#39;</span>
<span class="sd">    :type label: str</span>
<span class="sd">    :param parent:  Parent object, a View or an embedding Node object</span>
<span class="sd">    :type parent: [View | Node]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_type</span><span class="o">=</span><span class="s1">&#39;Element&#39;</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Node class parent should be a class View or Node instance!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">View</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">View</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="n">parent</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_view</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">ref</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;ref&#39; is not an instance of &#39;Element&#39; class.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">uuid</span>

        <span class="k">if</span> <span class="n">node_type</span> <span class="o">==</span> <span class="s1">&#39;Element&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid element reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">node_type</span> <span class="o">==</span> <span class="s2">&quot;Label&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">labels_dict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid element reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat</span> <span class="o">=</span> <span class="n">node_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lc_opacity</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="s1">&#39;Segoe UI&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_alignment</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_position</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_expression</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">border_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconColor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gradient</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Node.delete">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.delete">[docs]</a>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delete_from_model</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete node and related connections</span>

<span class="sd">        :param recurse:  Recurse into embedded nodes &amp; delete them as well</span>
<span class="sd">        :type recurse: bool</span>
<span class="sd">        :param delete_from_model: Also delete the related Element (always non-recursive)</span>
<span class="sd">        :type delete_from_model: bool</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># remove conns from or to this node in parent view connection dictionary</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">_source</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">_target</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span><span class="p">:</span>
                <span class="n">c</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">c</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">recurse</span><span class="p">:</span>
                <span class="c1"># delete embedded nodes</span>
                <span class="n">n</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># re-assign nodes ref to this node&#39;s parent</span>
                <span class="n">n</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">delete_from_model</span><span class="p">:</span>
            <span class="c1"># find if nodes in other views are referring to this element</span>
            <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span>
            <span class="n">related_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">e</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">related_nodes</span><span class="p">:</span>
                <span class="n">n</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">recurse</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></div>


<div class="viewcode-block" id="Node.add">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.add">[docs]</a>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_type</span><span class="o">=</span><span class="s1">&#39;Element&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nested_rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create a node embedded in this node</span>

<span class="sd">        :param ref:     Identifier of the related Element or an Element object</span>
<span class="sd">        :type ref: [str | Element]</span>
<span class="sd">        :param x:       top-left absolute x coordinate of the node in the view</span>
<span class="sd">        :type x: int</span>
<span class="sd">        :param y:       top-left absolute y coordinate of the node in the view</span>
<span class="sd">        :type y: int</span>
<span class="sd">        :param w:       width of the node</span>
<span class="sd">        :type w: int</span>
<span class="sd">        :param h:       height of the node</span>
<span class="sd">        :type h: int</span>
<span class="sd">        :param uuid:    Node identifier</span>
<span class="sd">        :type uuid: str</span>
<span class="sd">        :param node_type: Node type [&#39;Element&#39; | &#39;Label&#39; | &#39;Container&#39;]</span>
<span class="sd">        :type node_type: str</span>
<span class="sd">        :param label:   Label text if node type is not &#39;Element&#39;</span>
<span class="sd">        :type label: str</span>
<span class="sd">        :param nested_rel_type: type of nested relationship between the new node and its parent embedding one</span>
<span class="sd">        :type nested_rel_type: str</span>

<span class="sd">        :returns: Node object</span>
<span class="sd">        :rtype: Node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">node_type</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>

        <span class="c1"># An Embedded node should have a relationship between its parent concept</span>
        <span class="c1"># and the parent concept of the embedding node</span>

        <span class="c1"># TODO Check the logic to derive the nesting relationship</span>
        <span class="c1">#         # check if a relation already exist between the embedding and embedded elements</span>
        <span class="c1">#         rels = [r for r in self.model.rels_dict.values() if (r.source.uuid == self._uuid and r.target.uuid == n._uuid)</span>
        <span class="c1">#                 or (r.target.uuid == self._uuid and r.source.uuid == n._uuid)]</span>
        <span class="c1">#         if len(rels) == 0:</span>
        <span class="c1">#             # same types =&gt; Specialization</span>
        <span class="c1">#             if embed_rel_type == self.type:</span>
        <span class="c1">#                 self.model.add_relationship(embed_rel_type=ArchiTypes.Specialization, source=n.concept, target=self.concept)</span>
        <span class="c1">#             elif embed_rel_type is None:</span>
        <span class="c1">#                 # take the default one</span>
        <span class="c1">#                 embed_rel_type = get_default_rel_type(n.type, self.type)</span>
        <span class="c1">#                 try:</span>
        <span class="c1">#                     embed_rel_type = get_default_rel_type(self.type, n.type)</span>
        <span class="c1">#                     self.model.add_relationship(embed_rel_type=embed_rel_type, source=self.concept, target=n.concept)</span>
        <span class="c1">#                 except ArchimateRelationshipError:</span>
        <span class="c1">#                     # Sometime, there is no allowed type</span>
        <span class="c1">#                     log.warning(f&#39;{n.name} ({n.type}) should not be embedded into {self.name} ({self.type})&#39;)</span>
        <span class="c1">#             else:</span>
        <span class="c1">#                 self.model.add_relationship(embed_rel_type=embed_rel_type, source=self.concept, target=n.concept)</span>

        <span class="k">if</span> <span class="n">nested_rel_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_relationship</span><span class="p">(</span><span class="n">rel_type</span><span class="o">=</span><span class="n">nested_rel_type</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">n</span><span class="o">.</span><span class="n">concept</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the identifier of the node.</span>

<span class="sd">        :return: Identifier string</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of the node&#39;s Element concept</span>

<span class="sd">        :return: str : parent Element name</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Element&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">desc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Node description from the parent Element</span>
<span class="sd">        :return: description</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">desc</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the type of the node&#39;s parent Element concept</span>

<span class="sd">        :return: type</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Element&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">concept</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the referred Element concept object</span>

<span class="sd">        :return: Element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the identifier of the parent Element concept</span>

<span class="sd">        :return: Identifier str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span>

    <span class="nd">@ref</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the reference of the parent Element concept</span>
<span class="sd">        This method is used when merging two Elements (of the same type) or migrating the node to another parent Element</span>
<span class="sd">        It should be used with care as referring to an Element of another type may lead</span>
<span class="sd">        to invalid Archimate relationships</span>

<span class="sd">        :param ref: the identifier of the new parent Element</span>
<span class="sd">        :type ref: [str | Element]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">ref</span>
        <span class="k">if</span> <span class="n">new_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">new_ref</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the x-coordinate (top-left corner) of the node</span>

<span class="sd">        :return: int x</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@x</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the  top-left x-coordinate of a node</span>

<span class="sd">        This also move accordingly all embedded nodes and their children to a new relative position</span>

<span class="sd">        :param val:</span>
<span class="sd">        :type val: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the node centroid x coordinate</span>

<span class="sd">        :return: float cx</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cx</span><span class="p">)</span>

    <span class="nd">@cx</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of the centroid x coordinate</span>

<span class="sd">        :param val:</span>
<span class="sd">        :type val: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cx</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the relative  x coordinate wrt to embedding node</span>

<span class="sd">        :return:   rx</span>

<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@rx</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the x-coordinate relatively to the parent embedding node position</span>

<span class="sd">        :param value:</span>
<span class="sd">        :type value: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the top-left node y coordinate</span>

<span class="sd">        :return: y</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@y</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the top-left y-coordinate of the node and move all embedded children position</span>

<span class="sd">        :param val:</span>
<span class="sd">        :type val: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the node centroid y coordinate</span>

<span class="sd">        :return: cy</span>
<span class="sd">        :rtype: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cy</span><span class="p">)</span>

    <span class="nd">@cy</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the centroid y-coordinate</span>

<span class="sd">        :param val: centroid y</span>
<span class="sd">        :type val: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cy</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the node relative y coordinate wrt to embedding Node</span>

<span class="sd">        :return: y</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@ry</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the relative y coordinate of this node wrt to embedding node</span>

<span class="sd">        :param value:</span>
<span class="sd">        :type value: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the node width</span>

<span class="sd">        :return: w</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span>

    <span class="nd">@w</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set node width</span>

<span class="sd">        :param value:</span>
<span class="sd">        :type value: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get node height</span>

<span class="sd">        :return: h</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>

    <span class="nd">@h</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set node height</span>

<span class="sd">        :param value:</span>
<span class="sd">        :type value: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the fill color</span>

<span class="sd">        :return: #Hex color</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_color</span>

    <span class="nd">@fill_color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">fill_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the fill color of the Node.</span>

<span class="sd">        If color is None, reset to default value</span>

<span class="sd">        :param color_str: #Hex color string</span>
<span class="sd">        :type color_str: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">color_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fill_color</span> <span class="o">=</span> <span class="n">default_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fill_color</span> <span class="o">=</span> <span class="n">color_str</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get parent View object</span>

<span class="sd">        :return: View object</span>
<span class="sd">        :rtype: View</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get root Model</span>
<span class="sd">        :return: Model object</span>
<span class="sd">        :rtype: Model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="Node.getnodes">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.getnodes">[docs]</a>
    <span class="k">def</span> <span class="nf">getnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of children nodes</span>

<span class="sd">        :return: [Node]</span>
<span class="sd">        :rtype: list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">elem_type</span><span class="p">]</span></div>


<div class="viewcode-block" id="Node.get_or_create_node">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.get_or_create_node">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span>
                           <span class="n">create_elem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">create_node</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nested_rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get an existing node or to create a new one in this node</span>

<span class="sd">        :param elem:            Element object or name of the related Element concept</span>
<span class="sd">        :type elem: [str | Element]</span>
<span class="sd">        :param elem_type:       Archimate Element concept type if create_elem flag is set</span>
<span class="sd">        :type elem_type: str</span>
<span class="sd">        :param x:               top-left x position of the node</span>
<span class="sd">        :type x: int</span>
<span class="sd">        :param y:               top-left y position of the node</span>
<span class="sd">        :type y: int</span>
<span class="sd">        :param w:               node&#39;s width</span>
<span class="sd">        :type w: int</span>
<span class="sd">        :param h:               node&#39;s height</span>
<span class="sd">        :type h: int</span>
<span class="sd">        :param create_elem:     flag to create a new element with name &amp; type if not found</span>
<span class="sd">        :type create_elem: bool</span>
<span class="sd">        :param create_node:     flag to create a new node if not found</span>
<span class="sd">        :type create_node: bool</span>
<span class="sd">        :param nested_rel_type: relationship to use for nested node, else use a default value</span>
<span class="sd">        :type nested_rel_type:  Relationship</span>
<span class="sd">        :return:                Node object or None</span>
<span class="sd">        :rtype: [Node | None]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the element objects</span>
        <span class="n">_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
            <span class="n">_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_e</span> <span class="o">=</span> <span class="n">_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">create_elem</span><span class="p">:</span>
                <span class="n">_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">elem_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">elem</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_e</span> <span class="o">=</span> <span class="n">elem</span>

        <span class="c1"># get the related node object</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">_e</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">create_node</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">_e</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">nested_rel_type</span><span class="o">=</span><span class="n">nested_rel_type</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Node.is_inside">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.is_inside">[docs]</a>
    <span class="k">def</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the point given by the x,y coordinate is inside this node boundary</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x: int</span>
<span class="sd">        :param y:</span>
<span class="sd">        :type y: int</span>
<span class="sd">        :param point: a point object, overwriting x, y parameters if given</span>
<span class="sd">        :type point: Point</span>
<span class="sd">        :return: True of the point is inside the node boundary</span>
<span class="sd">        :rtype: bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">point</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="Node.resize">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.resize">[docs]</a>
    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_in_row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep_kids_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">gap_x</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">gap_y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
               <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resize the node, to fit all embedded nodes, recursively</span>

<span class="sd">        :param max_in_row:          Maximum number of embedded nodes per row</span>
<span class="sd">        :type max_in_row: int</span>
<span class="sd">        :param keep_kids_size:      Keep embedded node original size or set to default passed w,h parameters</span>
<span class="sd">        :type keep_kids_size: bool</span>
<span class="sd">        :param w:                   Default node width</span>
<span class="sd">        :type w: int</span>
<span class="sd">        :param h:                   Default node height</span>
<span class="sd">        :type h: int</span>
<span class="sd">        :param gap_x:               Horizontal gap between two nodes</span>
<span class="sd">        :type gap_x: int</span>
<span class="sd">        :param gap_y:               Vertical gap size between two nodes</span>
<span class="sd">        :type gap_y: int</span>
<span class="sd">        :param justify:             justify node to &#39;left&#39;, &#39;right&#39;, or &#39;center&#39;</span>
<span class="sd">        :type justify: str</span>
<span class="sd">        :param recurse:             recurse  &amp; resize embedded nodes</span>
<span class="sd">        :type recurse: bool</span>
<span class="sd">        :param sort:                one of &#39;asc&#39; | &#39;desc&#39; | &#39;none&#39;</span>
<span class="sd">        :type sort: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_w</span> <span class="o">=</span> <span class="n">w</span>
        <span class="n">max_h</span> <span class="o">=</span> <span class="n">h</span>

        <span class="n">ba_x</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="n">ba_y</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="n">max_row_h</span> <span class="o">=</span> <span class="n">h</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;asc&#39;</span> <span class="ow">in</span> <span class="n">sort</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;desc&#39;</span> <span class="ow">in</span> <span class="n">sort</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>

        <span class="k">for</span> <span class="n">_e</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">recurse</span><span class="p">:</span>
                <span class="n">_e</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">max_in_row</span><span class="o">=</span><span class="n">max_in_row</span><span class="p">,</span> <span class="n">keep_kids_size</span><span class="o">=</span><span class="n">keep_kids_size</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">gap_x</span><span class="o">=</span><span class="n">gap_x</span><span class="p">,</span> <span class="n">gap_y</span><span class="o">=</span><span class="n">gap_y</span><span class="p">,</span>
                          <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">)</span>

            <span class="n">min_w</span> <span class="o">=</span> <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">keep_kids_size</span><span class="p">)</span> <span class="k">else</span> <span class="n">w</span>
            <span class="n">min_h</span> <span class="o">=</span> <span class="n">_e</span><span class="o">.</span><span class="n">h</span> <span class="k">if</span> <span class="p">(</span><span class="n">h</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">keep_kids_size</span><span class="p">)</span> <span class="k">else</span> <span class="n">h</span>

            <span class="n">_e</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">ba_x</span>
            <span class="n">_e</span><span class="o">.</span><span class="n">ry</span> <span class="o">=</span> <span class="n">ba_y</span>
            <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">min_w</span>
            <span class="n">_e</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">min_h</span>

            <span class="n">max_row_h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_row_h</span><span class="p">,</span> <span class="n">_e</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
            <span class="n">ba_x</span> <span class="o">+=</span> <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">gap_x</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">max_in_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">justify</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                    <span class="n">ba_x</span> <span class="o">=</span> <span class="mi">40</span> <span class="k">if</span> <span class="n">row</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">40</span> <span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">gap_x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ba_x</span> <span class="o">=</span> <span class="mi">40</span>
                <span class="n">ba_y</span> <span class="o">+=</span> <span class="n">max_row_h</span> <span class="o">+</span> <span class="n">gap_y</span>
                <span class="n">max_row_h</span> <span class="o">=</span> <span class="n">h</span>

            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">max_w</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_w</span><span class="p">,</span> <span class="n">_e</span><span class="o">.</span><span class="n">rx</span> <span class="o">+</span> <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">gap_x</span><span class="p">)</span>
            <span class="n">max_h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_h</span><span class="p">,</span> <span class="n">_e</span><span class="o">.</span><span class="n">ry</span> <span class="o">+</span> <span class="n">_e</span><span class="o">.</span><span class="n">h</span> <span class="o">+</span> <span class="n">gap_y</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">max_w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">max_h</span>

        <span class="k">if</span> <span class="n">justify</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">%</span> <span class="n">max_in_row</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">_e</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">_e</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">max_w</span> <span class="o">-</span> <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="n">gap_x</span>
                <span class="n">max_w</span> <span class="o">=</span> <span class="n">_e</span><span class="o">.</span><span class="n">rx</span>
            <span class="k">if</span> <span class="n">max_in_row</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_e</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                    <span class="n">_e</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">max_w</span> <span class="o">-</span> <span class="n">_e</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="n">gap_x</span></div>


<div class="viewcode-block" id="Node.conns">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.conns">[docs]</a>
    <span class="k">def</span> <span class="nf">conns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all connections of the given type connected to the node</span>

<span class="sd">        :param rel_type: an Archimate relationship type</span>
<span class="sd">        :type rel_type: str</span>

<span class="sd">        :return: [Connection]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span>
                    <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)]</span></div>


<div class="viewcode-block" id="Node.in_conns">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.in_conns">[docs]</a>
    <span class="k">def</span> <span class="nf">in_conns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all connections of the given type where the node is target to (inbound conns)</span>

<span class="sd">        :param rel_type: an Archimate relationships type</span>
<span class="sd">        :type rel_type: str</span>

<span class="sd">        :return: [Connection]</span>
<span class="sd">        :rtype: list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span></div>


<div class="viewcode-block" id="Node.out_conns">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.out_conns">[docs]</a>
    <span class="k">def</span> <span class="nf">out_conns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all connections of the given type where the node is source to (outbound conns)</span>

<span class="sd">        :param rel_type: an Archimate relationships type</span>
<span class="sd">        :type rel_type: str</span>

<span class="sd">        :return: [Connection]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span></div>


<div class="viewcode-block" id="Node.get_obj_pos">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.get_obj_pos">[docs]</a>
    <span class="k">def</span> <span class="nf">get_obj_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Position</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get positional parameter of this node with respect to another one using centroid coordinates</span>

<span class="sd">        :param other_node: a Node object</span>
<span class="sd">        :type other_node: Node</span>

<span class="sd">        :return: a Position object:</span>
<span class="sd">        :rtype: Position</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">Position</span><span class="p">()</span>
        <span class="n">position</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="n">position</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span>

        <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="c1"># normalize angle wrt obj1</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">360</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">position</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>

        <span class="c1"># Set the orientation</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">45</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">315</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>
        <span class="k">elif</span> <span class="mi">45</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">135</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="k">elif</span> <span class="mi">135</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">225</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
        <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">pos</span>

        <span class="c1"># Calculate the gaps between objects</span>
        <span class="k">if</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> \
                <span class="ow">and</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> \
                <span class="ow">and</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> \
                <span class="ow">and</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> \
                <span class="ow">and</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">=</span> <span class="n">other_node</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">other_node</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Adjust the orientation for adjacent overlapping edges</span>
        <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;T!&quot;</span>
        <span class="k">elif</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;B!&quot;</span>
        <span class="k">elif</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;L!&quot;</span>
        <span class="k">elif</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;R!&quot;</span>

        <span class="k">return</span> <span class="n">position</span></div>


<div class="viewcode-block" id="Node.get_point_pos">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.get_point_pos">[docs]</a>
    <span class="k">def</span> <span class="nf">get_point_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Position</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get positional parameter of this node center (x,y) points with respect to a point</span>

<span class="sd">        :param point: centroid (x, y) coordinate of a Node</span>
<span class="sd">        :type point: Point</span>
<span class="sd">        :return: Position object</span>
<span class="sd">        :rtype: Point</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">Position</span><span class="p">()</span>
        <span class="n">position</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span>
        <span class="n">position</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span>
        <span class="n">position</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">dx</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">position</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>

        <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">dy</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">dx</span><span class="p">))</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">360</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">position</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">135</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">225</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>
            <span class="k">elif</span> <span class="mi">225</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">315</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
            <span class="k">elif</span> <span class="n">angle</span> <span class="o">&gt;=</span> <span class="mi">315</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">270</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;L!&#39;</span>
        <span class="k">elif</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">180</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;B!&#39;</span>
        <span class="k">elif</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">180</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;T!&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;R!&#39;</span>

        <span class="n">position</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="n">position</span></div>


<div class="viewcode-block" id="Node.distribute_connections">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.distribute_connections">[docs]</a>
    <span class="k">def</span> <span class="nf">distribute_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to arrange and distribute equally all visual conns along each edge of this node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">left</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">obj1</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># For all conns from/to this node</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conns</span><span class="p">():</span>
            <span class="c1"># Get the actual bendpoints</span>
            <span class="n">bps</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get_all_bendpoints</span><span class="p">()</span>
            <span class="c1"># Set the source and destination objects</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
                <span class="n">obj2</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span>
                <span class="n">obj1</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">obj1</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span>
                <span class="n">obj2</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span>

            <span class="c1"># Evaluate the position of the other object</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">get_obj_pos</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">angle</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">orientation</span>

            <span class="c1"># only manage conns that are related to non-embedded objects</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obj1</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">obj2</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">cy</span><span class="p">):</span>
                <span class="c1"># if a connection does not have any bendpoint, add one in the middle of connection,</span>
                <span class="c1"># so we can also reposition it</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Calculate the position of this new bendpoint</span>
                    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;L!&#39;</span><span class="p">:</span>
                        <span class="n">_x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">_y</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span>
                    <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;R!&#39;</span><span class="p">:</span>
                        <span class="n">_x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="n">obj1</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">gap_x</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">_y</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span>
                    <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;B!&#39;</span><span class="p">:</span>
                        <span class="n">_y</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">obj1</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">_x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span>
                    <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;T!&#39;</span><span class="p">:</span>
                        <span class="n">_y</span> <span class="o">=</span> <span class="n">obj2</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">obj2</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">gap_y</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">_x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj2</span><span class="o">.</span><span class="n">cx</span> <span class="o">+</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj2</span><span class="o">.</span><span class="n">cy</span> <span class="o">+</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="c1"># Add it to the connection &amp; refresh the list</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">add_bendpoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">))</span>
                    <span class="n">bps</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get_all_bendpoints</span><span class="p">()</span>

                <span class="c1"># Select the bendpoint which is closer to this node</span>
                <span class="c1"># This is the bendpoint to reposition in this process</span>
                <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
                    <span class="n">bp</span> <span class="o">=</span> <span class="n">bps</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">bps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">bp</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bp</span> <span class="o">=</span> <span class="n">bps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">bp</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># Get position information about this bendpoint wrt to this node</span>
                <span class="n">bp_pos</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">get_point_pos</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span>

                <span class="c1"># Sort bendpoint by edge</span>
                <span class="k">if</span> <span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">bp_pos</span><span class="o">.</span><span class="n">orientation</span><span class="p">:</span>
                    <span class="c1"># Add all bendpoints on the right edge of this node in the &#39;right&#39; list</span>
                    <span class="c1"># angle = (angle + 180) % 360</span>
                    <span class="n">right</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span> <span class="n">bp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">})</span>
                <span class="c1"># and do the same for the other edges</span>
                <span class="k">if</span> <span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">bp_pos</span><span class="o">.</span><span class="n">orientation</span><span class="p">:</span>
                    <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
                    <span class="n">left</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span> <span class="n">bp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">})</span>

                <span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">bp_pos</span><span class="o">.</span><span class="n">orientation</span><span class="p">:</span>
                    <span class="n">top</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span> <span class="n">bp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">})</span>

                <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">bp_pos</span><span class="o">.</span><span class="n">orientation</span><span class="p">:</span>
                    <span class="c1"># angle = (angle + 180) % 360</span>
                    <span class="n">bottom</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span> <span class="n">bp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">})</span>

        <span class="c1"># When all relationships and bendpoints are sorted by edge, reposition them</span>
        <span class="c1"># Sort the bendpoint in function of the position of the other node to this node</span>
        <span class="c1"># so that the connection does not cross whith others</span>
        <span class="c1"># and calculate the position of the bendpoint to distribute them over the edge</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># r[&#39;bp&#39;].x = r[&#39;bp&#39;].x + 5*i * ((r.order &gt; 180)? 1:-1)</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bendpoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># r[&#39;bp&#39;].x = r[&#39;bp&#39;].x + 5*i * ((r.order &gt; 180)? 1:-1)</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bendpoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bendpoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">obj1</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">r</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bendpoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;bp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span></div>


<div class="viewcode-block" id="Node.move">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Node.move">[docs]</a>
    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_parent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move a Node to another Node on the same view or to its root view</span>
<span class="sd">        :param new_parent: new parent object</span>
<span class="sd">        :rtype new_parent: Node | View</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_parent</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_parent</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid target to move the node to. Expecting a View or a Node&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">uuid</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot move a node outside of its view&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">new_parent</span>
        <span class="n">new_parent</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span></div>
</div>



<div class="viewcode-block" id="Connection">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection">[docs]</a>
<span class="k">class</span> <span class="nc">Connection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage visual connections between Nodes</span>


<span class="sd">    :param ref:         Reference to the parent Relationship concept</span>
<span class="sd">    :type ref: [str | Relationship]</span>
<span class="sd">    :param source:      Source Node or node uuid of the connection</span>
<span class="sd">    :type source: [str | Node]</span>
<span class="sd">    :param target:      Target Node or node uuid of the connection</span>
<span class="sd">    :type target: [ | Node</span>
<span class="sd">    :param uuid:        uuid of the connection (read-only excepted when reading an XML file to set the identifier)</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param parent:      Parent&#39;s view</span>
<span class="sd">    :type parent: View</span>

<span class="sd">    :raises ArchimateConceptTypeError: Exception raised if invalid Archimate object type given</span>
<span class="sd">    :raises ValueError:  Exception raise if a reference is not found in the model object dictionaries</span>

<span class="sd">    :returns: Connection object</span>
<span class="sd">    :rtype: Conenction</span>
<span class="sd">   &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">View</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s1">&#39;Connection class parent should be a class View instance!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">View</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">ref</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s2">&quot;&#39;ref&#39; is not an instance of &#39;Relationship&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid relationship reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s2">&quot;&#39;source&#39; is not an instance of &#39;Node&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid source reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s2">&quot;&#39;target&#39; is not an instance of &#39;Node&#39; class.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid source reference &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="c1"># set default style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="s1">&#39;Segoe UI&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_position</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_label</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Connection.delete">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.delete">[docs]</a>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete this Connection</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get Connection identifier</span>

<span class="sd">        :return: Identifier</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the parent Relationship reference</span>

<span class="sd">        :return: Identifier</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span>

    <span class="nd">@ref</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new Relationship reference to this connection</span>

<span class="sd">        :param ref: Reference to a Relationship</span>
<span class="sd">        :type ref: [str | Relationship]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">ref</span>
        <span class="k">if</span> <span class="n">new_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref</span> <span class="o">=</span> <span class="n">new_ref</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">concept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Relationship object referred by ref</span>

<span class="sd">        :return: Relationship object</span>
<span class="sd">        :rtype: Relationship</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the type of the parent relationship</span>

<span class="sd">        :return: type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of the parent Relationship</span>

<span class="sd">        :return: name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Node object at the source of the relationship</span>

<span class="sd">        :return: Node object</span>
<span class="sd">        :rtype: Node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">]</span>

    <span class="nd">@source</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new source Node object to this</span>

<span class="sd">        :param elem:</span>
<span class="sd">        :type elem: [str|Node]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">elem</span>
        <span class="k">if</span> <span class="n">new_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">new_ref</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the target Node object</span>

<span class="sd">        :return: Node object</span>
<span class="sd">        :rtype: Node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">]</span>

    <span class="nd">@target</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new target Node to this relationship</span>

<span class="sd">        :param elem:</span>
<span class="sd">        :type elem: [str|Node]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_ref</span> <span class="o">=</span> <span class="n">elem</span>
        <span class="k">if</span> <span class="n">new_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">new_ref</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">access_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">access_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">is_directed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">influence_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">influence_strength</span>

<div class="viewcode-block" id="Connection.add_bendpoint">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.add_bendpoint">[docs]</a>
    <span class="k">def</span> <span class="nf">add_bendpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">bendpoints</span><span class="p">:</span> <span class="n">Point</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add one or multiple bendpoints x-y Point to shape the connection</span>

<span class="sd">        :param bendpoints:</span>
<span class="sd">        :type bendpoints: Point, Point, ...</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">bendpoints</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span></div>


<div class="viewcode-block" id="Connection.set_bendpoint">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.set_bendpoint">[docs]</a>
    <span class="k">def</span> <span class="nf">set_bendpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bp</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set an existing bendpoint to another xy-Point</span>

<span class="sd">        :param bp:</span>
<span class="sd">        :type bp: Point</span>
<span class="sd">        :param index:</span>
<span class="sd">        :type index: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">bp</span></div>


<div class="viewcode-block" id="Connection.get_bendpoint">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.get_bendpoint">[docs]</a>
    <span class="k">def</span> <span class="nf">get_bendpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the benpoint at the given index position (O is the first bendpoint at the source object)</span>

<span class="sd">        :param index:</span>
<span class="sd">        :type index: int</span>
<span class="sd">        :return: Point object</span>
<span class="sd">        :rtype: Point|None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Connection.del_bendpoint">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.del_bendpoint">[docs]</a>
    <span class="k">def</span> <span class="nf">del_bendpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete an endpoint by index position</span>

<span class="sd">        :param index:</span>
<span class="sd">        :type index: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div>


<div class="viewcode-block" id="Connection.get_all_bendpoints">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.get_all_bendpoints">[docs]</a>
    <span class="k">def</span> <span class="nf">get_all_bendpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of all bendpoints</span>

<span class="sd">        :return: [Point]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span></div>


<div class="viewcode-block" id="Connection.remove_all_bendpoints">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.remove_all_bendpoints">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_all_bendpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove all bendpoint of the Connection</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bendpoints</span> <span class="o">=</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Connection.l_shape">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.l_shape">[docs]</a>
    <span class="k">def</span> <span class="nf">l_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the connection using a L-shape (one bendpoint, orthogonal shape)</span>

<span class="sd">        :param direction: 0 start with a horizontal segment, or 1 for a vertical one</span>
<span class="sd">        :type direction: int</span>
<span class="sd">        :param weight_x:  0...1 position of the bendpoint on the x-axis</span>
<span class="sd">        :type weight_x: float</span>
<span class="sd">        :param weight_y:  0...1 position of the bendpoint on the y-axis</span>
<span class="sd">        :type weight_y: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_all_bendpoints</span><span class="p">()</span>
        <span class="n">s_cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">cx</span>
        <span class="n">s_cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">cy</span>
        <span class="n">t_cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">cx</span>
        <span class="n">t_cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">cy</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">s_cx</span> <span class="o">-</span> <span class="n">t_cx</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">s_cy</span> <span class="o">-</span> <span class="n">t_cy</span>

        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">t_cx</span><span class="p">,</span> <span class="n">s_cy</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">t_cx</span><span class="p">,</span> <span class="n">s_cy</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_bendpoint</span><span class="p">(</span>
                <span class="n">Point</span><span class="p">(</span><span class="n">t_cx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_x</span><span class="p">),</span> <span class="n">s_cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_y</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">s_cx</span><span class="p">,</span> <span class="n">t_cy</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">s_cx</span><span class="p">,</span> <span class="n">t_cy</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_bendpoint</span><span class="p">(</span>
                <span class="n">Point</span><span class="p">(</span><span class="n">s_cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_x</span><span class="p">),</span>
                      <span class="n">t_cy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_y</span><span class="p">))</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Connection.s_shape">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Connection.s_shape">[docs]</a>
    <span class="k">def</span> <span class="nf">s_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">weight2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the connection using a S-shape (two bendpoints, orthogonal shape)</span>

<span class="sd">        :param direction: 0 starts with a horizontal segment, or 1 for a vertical one</span>
<span class="sd">        :type direction: int</span>
<span class="sd">        :param weight_x:  0...1 position of the first bendpoint on the x-axis</span>
<span class="sd">        :type weight_x: float</span>
<span class="sd">        :param weight_y:  0...1 position of the first bendpoint on the y-axis</span>
<span class="sd">        :type weight_y: float</span>
<span class="sd">        :param weight2:   0...1 position of the second bendpoint</span>
<span class="sd">        :type weight2: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_all_bendpoints</span><span class="p">()</span>
        <span class="n">s_xy</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span>
        <span class="n">t_xy</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">t_xy</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">s_xy</span><span class="o">.</span><span class="n">x</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">t_xy</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">s_xy</span><span class="o">.</span><span class="n">y</span>

        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bp1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">s_xy</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">weight_x</span><span class="p">,</span> <span class="n">s_xy</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_y</span><span class="p">))</span>
            <span class="n">bp2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">bp1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">t_xy</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bp1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">s_xy</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight_x</span><span class="p">),</span>
                        <span class="n">s_xy</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">weight_y</span><span class="p">)</span>
            <span class="n">bp2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">t_xy</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">weight2</span><span class="p">),</span> <span class="n">bp1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">bp1</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">bp1</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">bp1</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">bp2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_bendpoint</span><span class="p">(</span><span class="n">bp1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_bendpoint</span><span class="p">(</span><span class="n">bp2</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="View">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View">[docs]</a>
<span class="k">class</span> <span class="nc">View</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage the views (diagrams) in an Archimate model</span>

<span class="sd">    :param name:    Name of the view</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param uuid:    Identifier of the view</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param desc:    Description of the view content</span>
<span class="sd">    :type desc: str</span>
<span class="sd">    :param folder:  folder path (organization) to structure view hierarchy</span>
<span class="sd">    :type folder: str</span>
<span class="sd">    :param parent:  parent Model object reference</span>
<span class="sd">    :type parent: Model</span>
<span class="sd">    :raises ArchimateConceptTypeError: Exception raised if an invalid parent object type is given</span>

<span class="sd">    :returns: View object</span>
<span class="sd">    :rtype: View</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ArchimateConceptTypeError</span><span class="p">(</span><span class="s1">&#39;View class parent should be a class Model instance!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># the view points to itself - it is the root of the nodes in the diagram</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Connection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span>

<div class="viewcode-block" id="View.delete">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.delete">[docs]</a>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete this view from its model</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Delete all nodes from the view</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">n</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">n</span>
        <span class="c1"># delete all connections from the view</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">c</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">c</span>
        <span class="c1"># remove this view from the parent&#39;s dictionaries</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">views_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">views_dict</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span></div>


<div class="viewcode-block" id="View.add">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.add">[docs]</a>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_type</span><span class="o">=</span><span class="s1">&#39;Element&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add a node in this view</span>

<span class="sd">        :param ref:             Identifier of the node&#39;s Element concept</span>
<span class="sd">        :type ref: [str|Element]</span>
<span class="sd">        :param x:               top-left x position of the node in the view</span>
<span class="sd">        :type x: int</span>
<span class="sd">        :param y:               top-left y position</span>
<span class="sd">        :type y: int</span>
<span class="sd">        :param w:               node&#39;s width</span>
<span class="sd">        :type w: int</span>
<span class="sd">        :param h:               node&#39;s height</span>
<span class="sd">        :type h: int</span>
<span class="sd">        :param uuid:            node&#39;s Identifier</span>
<span class="sd">        :type uuid: str</span>
<span class="sd">        :param node_type:       node&#39;s category (Element, Label or Container)</span>
<span class="sd">        :type node_type: str</span>
<span class="sd">        :param label:           Label of a Label or Container type node</span>
<span class="sd">        :type label: str</span>

<span class="sd">        :return:                Node object</span>
<span class="sd">        :rtype: Node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">node_type</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">return</span> <span class="n">n</span></div>


<div class="viewcode-block" id="View.add_connection">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.add_connection">[docs]</a>
    <span class="k">def</span> <span class="nf">add_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add a connection between two nodes in this view</span>

<span class="sd">        :param ref:             Identifier of the connnection&#39;s Relationship</span>
<span class="sd">        :type ref: [str|Relationship]</span>
<span class="sd">        :param source:          Source node of the connection (its Identifier or the node object itself)</span>
<span class="sd">        :type source: [str|Node]</span>
<span class="sd">        :param target:          Target node of the connection</span>
<span class="sd">        :type target: [str|Node]</span>
<span class="sd">        :param uuid:            Identifier of the connection</span>
<span class="sd">        :type uuid: str</span>
<span class="sd">        :return:                Connection object</span>
<span class="sd">        :rtype: Connection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conns_dict</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">c</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the identifier of the connection</span>

<span class="sd">        :return: Identifier</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the type of the view</span>

<span class="sd">        :return: type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Diagram&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the dictionary of view properties (Read-only)</span>

<span class="sd">        :return: Properties dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span>

<div class="viewcode-block" id="View.prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.prop">[docs]</a>
    <span class="k">def</span> <span class="nf">prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get or set a view&#39;s property</span>

<span class="sd">        :param key:     Property key</span>
<span class="sd">        :type key: str</span>
<span class="sd">        :param value:   Property value</span>
<span class="sd">        :type value: str</span>

<span class="sd">        :return: an existing element property value if &#39;value&#39; argument is None</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="View.remove_prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.remove_prop">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove a view property</span>

<span class="sd">        :param key:</span>
<span class="sd">        :type key: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of nodes objects, defined in this view</span>
<span class="sd">        :return:list of nodes</span>
<span class="sd">        :rtype:  list(Node)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of connections objects defined in this view</span>
<span class="sd">        :return: list of connections</span>
<span class="sd">        :rtype: list(Connection)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="View.remove_folder">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.remove_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove this view from the organization hierarchy</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="View.get_or_create_node">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.get_or_create_node">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span>
                           <span class="n">create_elem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">create_node</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get an existing node or to create a new one in this view</span>

<span class="sd">        :param elem:            Element object or name of the related Element concept</span>
<span class="sd">        :type elem: [str|Element]</span>
<span class="sd">        :param elem_type:       Archimate Element concept type if create_elem flag is set</span>
<span class="sd">        :type elem_type: str</span>
<span class="sd">        :param x:               top-left x position of the node</span>
<span class="sd">        :type x: int</span>
<span class="sd">        :param y:               top-left y position of the node</span>
<span class="sd">        :type y: int</span>
<span class="sd">        :param w:               node&#39;s width</span>
<span class="sd">        :type w: int</span>
<span class="sd">        :param h:               node&#39;s height</span>
<span class="sd">        :type h: int</span>
<span class="sd">        :param create_elem:     flag to create a new element with name &amp; type if not found</span>
<span class="sd">        :type create_elem: bool</span>
<span class="sd">        :param create_node:     flag to create a new node if not found</span>
<span class="sd">        :type create_node: bool</span>
<span class="sd">        :return:                Node object or None</span>
<span class="sd">        :rtype: Node|None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the element objects</span>
        <span class="n">_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
            <span class="n">_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_e</span> <span class="o">=</span> <span class="n">_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">create_elem</span><span class="p">:</span>
                <span class="n">_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">elem_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">elem</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_e</span> <span class="o">=</span> <span class="n">elem</span>

        <span class="c1"># get the related node object</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">_e</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">create_node</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">_e</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="View.get_or_create_connection">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.View.get_or_create_connection">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">create_conn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Connection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get or create a connection between two nodes in this view</span>

<span class="sd">        If no Parent Relationship is given, a search is performed on existing relationships with same attributes</span>
<span class="sd">        (type, source, target and name if given)</span>

<span class="sd">        :param rel: Parent Relationship object referred by the connection or None if a new relationship is to be created</span>
<span class="sd">        :type rel: [str|Relationship]</span>
<span class="sd">        :param source:      Source node of the connection</span>
<span class="sd">        :type source: [str|Node]</span>
<span class="sd">        :param target:      Target node of the connection</span>
<span class="sd">        :type target: [str|Node]</span>
<span class="sd">        :param rel_type:    Archimate relationship type to search the parent Relationship or</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">                            used when a new relationship is to be created</span>
<span class="sd">        :param name:        Name of the new relationship</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param create_conn: flag to create a new connection if not found</span>
<span class="sd">        :type create_conn: bool</span>
<span class="sd">        :return:            Connection object</span>
<span class="sd">        :rtype: Connection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># get the relationships</span>
        <span class="k">if</span> <span class="n">rel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Search relationship having tha same type</span>
            <span class="c1"># and the same source, target than the source/target node&#39;s concepts</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                                    <span class="n">rel_type</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
                                                    <span class="ow">and</span> <span class="n">target</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
                                                    <span class="p">)</span>
                <span class="c1"># r = self.find_relationships(embed_rel_type=embed_rel_type, elem=source.concept, direction=&#39;out&#39;)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># And if provided with the same relationship name</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                                    <span class="p">(</span><span class="n">rel_type</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">target</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
                                                    <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Return the fist in the list</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Or create a new Relationship between the source and target Element concepts</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_relationship</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">ref</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">ref</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="n">rel_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rel</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">rel</span>
            <span class="n">rel_type</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Get the connection</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">ref</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">create_conn</span><span class="p">:</span>
            <span class="c1"># Don&#39;t create connection if target node is embedded into source node</span>
            <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">uuid</span> <span class="o">!=</span> <span class="n">source</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">add_connection</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">c</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>
</div>



<div class="viewcode-block" id="Model">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model">[docs]</a>
<span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to create a Archimate compliant models</span>

<span class="sd">    Note: Perspectives are not handled in the current version of this library</span>

<span class="sd">    This class define the methods and properties to create Elements, Relationships, Diagrams (Views) with Nodes and</span>
<span class="sd">    Connections with visual layout</span>

<span class="sd">    It also reads, writes or merges XML files using the Archimate Open Exchange File format</span>

<span class="sd">    :param name:    Model name</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param uuid:    Model Identifier</span>
<span class="sd">    :type uuid: str</span>
<span class="sd">    :param desc:    Model documentation</span>
<span class="sd">    :type desc: str</span>

<span class="sd">    :returns: Model object</span>
<span class="sd">    :rtype: Model</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdefs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Relationship</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Connection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">View</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="s1">&#39;archi&#39;</span>

        <span class="c1"># with open(os.path.join(__location__, &#39;archimate3_Diagram.xsd&#39;), &#39;r&#39;) as _f:</span>
        <span class="c1">#     self.schemaD = _f.read()</span>
        <span class="c1"># with open(os.path.join(__location__, &#39;archimate3_Model.xsd&#39;), &#39;r&#39;) as _f:</span>
        <span class="c1">#     self.schemaM = _f.read()</span>
        <span class="c1"># with open(os.path.join(__location__, &#39;archimate3_View.xsd&#39;), &#39;r&#39;) as _f:</span>
        <span class="c1">#     self.schemaV = _f.read()</span>

<div class="viewcode-block" id="Model.add">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.add">[docs]</a>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">concept_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add a new Element in this model</span>

<span class="sd">        :param concept_type:    Archimate Element type</span>
<span class="sd">        :type concept_type: str</span>
<span class="sd">        :param name:            Element&#39;s name</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param uuid:            Element&#39;s Identifier</span>
<span class="sd">        :type uuid: str</span>
<span class="sd">        :param desc:            Element&#39;s documentation</span>
<span class="sd">        :type desc: str</span>
<span class="sd">        :param folder:          Element&#39;s organization path</span>
<span class="sd">        :type folder: str</span>
<span class="sd">        :return:                Element or View class object</span>
<span class="sd">        :rtype: Element|View</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">concept_type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">View</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">desc</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_e</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">concept_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">desc</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">[</span><span class="n">_e</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">_e</span>
            <span class="k">return</span> <span class="n">_e</span></div>


<div class="viewcode-block" id="Model.add_relationship">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.add_relationship">[docs]</a>
    <span class="k">def</span> <span class="nf">add_relationship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">access_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">influence_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Relationship</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add a new Relationship between two Element objects</span>

<span class="sd">        :param rel_type:                Archimate relationship type</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">        :param source:                  Source Element by Identifier or by object</span>
<span class="sd">        :type source: [str|Element]</span>
<span class="sd">        :param target:                  Target Element by Identifier or by object</span>
<span class="sd">        :type target: [str|Element]</span>
<span class="sd">        :param uuid:                    Relationship Identifier</span>
<span class="sd">        :type uuid: str</span>
<span class="sd">        :param name:                    Relationship name</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param access_type:             if type is Access, type of Access (Read, Write...)</span>
<span class="sd">        :type access_type: str</span>
<span class="sd">        :param influence_strength:      if type is Influence, strength of the influence (1, 10, +,++...)</span>
<span class="sd">        :type influence_strength: str</span>
<span class="sd">        :param desc:                    Relationship documentation</span>
<span class="sd">        :type desc: str</span>
<span class="sd">        :param is_directed:             if type is Association, flag to indicated if the relationhsip is directed</span>
<span class="sd">        :type is_directed: bool</span>
<span class="sd">        :return:                        Relationship class object</span>
<span class="sd">        :rtype: Relationship</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">rel_type</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">access_type</span><span class="p">,</span> <span class="n">influence_strength</span><span class="p">,</span> <span class="n">desc</span><span class="p">,</span>
                         <span class="n">is_directed</span><span class="p">,</span>
                         <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
        <span class="k">return</span> <span class="n">r</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Model Identifier</span>

<span class="sd">        :return: Identifer</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uuid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the type of Model</span>
<span class="sd">        :return: type</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Model&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of model properties (read only)</span>

<span class="sd">        :return: properties dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span>

<div class="viewcode-block" id="Model.prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.prop">[docs]</a>
    <span class="k">def</span> <span class="nf">prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get or set an element&#39;s property</span>

<span class="sd">        :param key:     Property key</span>
<span class="sd">        :type key: str</span>
<span class="sd">        :param value:   Property value</span>
<span class="sd">        :type value: str</span>
<span class="sd">        :return: an existing element property value if &#39;value&#39; argument is None</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Model.remove_prop">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.remove_prop">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove an element property</span>

<span class="sd">        :param key:</span>
<span class="sd">        :type key: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">views</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of views in this model</span>

<span class="sd">        :return: [View]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of Elements in this model</span>

<span class="sd">        :return: [Element]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of Relationships in this Model</span>

<span class="sd">        :return: [Relationship]</span>
<span class="sd">        :rtype: list</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of all nodes from the model</span>
<span class="sd">        :return: Nodes</span>
<span class="sd">        :rtype: list(Node)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of all connections from the model</span>
<span class="sd">        :return: Connections</span>
<span class="sd">        :rtype: list(Connection)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="Model.write">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.write">[docs]</a>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">Writers</span><span class="o">.</span><span class="n">archimate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to write the file_path to an Archimate file</span>

<span class="sd">        :param file_path:</span>
<span class="sd">        :type file_path: str</span>
<span class="sd">        :param writer: a writer function converting the model into the desired output format, default: Archimate OEF XML</span>
<span class="sd">        :type writer: Writers</span>
<span class="sd">        :return:  data structure</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.writers.archimateWriter</span> <span class="kn">import</span> <span class="n">archimate_writer</span>
        <span class="kn">from</span> <span class="nn">.writers.csvWriter</span> <span class="kn">import</span> <span class="n">csv_writer</span>
        <span class="kn">from</span> <span class="nn">.writers.archiWriter</span> <span class="kn">import</span> <span class="n">archi_writer</span>
        <span class="k">if</span> <span class="n">writer</span> <span class="o">==</span> <span class="n">Writers</span><span class="o">.</span><span class="n">archimate</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">archimate_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">writer</span> <span class="o">==</span> <span class="n">Writers</span><span class="o">.</span><span class="n">csv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csv_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">archi_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.read">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.read">[docs]</a>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read an Archimate file</span>
<span class="sd">        The method detects automagically and read the following formats:</span>
<span class="sd">        - ARIS AML</span>
<span class="sd">        - Open Group Open Exchange File</span>
<span class="sd">        - Archi Tool</span>

<span class="sd">        :param file_path:</span>
<span class="sd">        :type file_path: str</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                <span class="n">_data</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="fm">__mod__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.read: Cannot open or read file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">recover</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">parser</span><span class="o">=</span><span class="n">parser</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">.readers.archimateReader</span> <span class="kn">import</span> <span class="n">archimate_reader</span>
        <span class="kn">from</span> <span class="nn">.readers.archiReader</span> <span class="kn">import</span> <span class="n">archi_reader</span>
        <span class="kn">from</span> <span class="nn">.readers.arisAMLreader</span> <span class="kn">import</span> <span class="n">aris_reader</span>
        <span class="k">if</span> <span class="s1">&#39;opengroup&#39;</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">archimate_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;archimate&#39;</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">archi_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;AML&#39;</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">aris_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Unsupported input format&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.merge">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.merge">[docs]</a>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to merge an Archimate file into this model</span>

<span class="sd">        :param file_path:</span>
<span class="sd">        :type file_path: str</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                <span class="n">_data</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="fm">__mod__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.read: Cannot open or read file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">_data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="kn">from</span> <span class="nn">.readers.archimateReader</span> <span class="kn">import</span> <span class="n">archimate_reader</span>
        <span class="kn">from</span> <span class="nn">.readers.archiReader</span> <span class="kn">import</span> <span class="n">archi_reader</span>
        <span class="c1"># self from .readers.arisAMLreader import aris_reader</span>
        <span class="k">if</span> <span class="s1">&#39;opengroup&#39;</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">archimate_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">merge_flg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;archimate&#39;</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">archi_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">merge_flg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Unsupported input format for merge operation&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.filter_elements">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.filter_elements">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fct</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to filter Elements</span>

<span class="sd">        :param fct: callback (lambda) function with filtering criteria</span>
<span class="sd">        :type fct: function</span>
<span class="sd">        :return: list of Elements</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">fct</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span></div>


<div class="viewcode-block" id="Model.find_elements">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.find_elements">[docs]</a>
    <span class="k">def</span> <span class="nf">find_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to find elements by name or type or both</span>

<span class="sd">        :param name:        name criteria</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param elem_type:   elem_type criteria</span>
<span class="sd">        :type elem_type: str</span>
<span class="sd">        :return: list(Element)</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">elem_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">elem_type</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="ow">and</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">elem_type</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>


<div class="viewcode-block" id="Model.find_relationships">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.find_relationships">[docs]</a>
    <span class="k">def</span> <span class="nf">find_relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all relationships of a list of elements</span>

<span class="sd">        :param rel_type: type of relationship tp search for</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">        :param elem: an element with relationships</span>
<span class="sd">        :type elem: Element</span>
<span class="sd">        :param direction: data direction [&#39;in_rels&#39;, &#39;out_rels&#39;, &#39;both&#39; | None]</span>
<span class="sd">        :type direction: str</span>
<span class="sd">        :return: [Relationship]</span>
<span class="sd">        :rtype: list</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rel_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;in&#39;</span> <span class="ow">in</span> <span class="n">direction</span> <span class="ow">or</span> <span class="s1">&#39;both&#39;</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">and</span> <span class="n">rel_type</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;out&#39;</span> <span class="ow">in</span> <span class="n">direction</span> <span class="ow">or</span> <span class="s1">&#39;both&#39;</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">and</span> <span class="n">rel_type</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;in&#39;</span> <span class="ow">in</span> <span class="n">direction</span> <span class="ow">or</span> <span class="s1">&#39;both&#39;</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;out&#39;</span> <span class="ow">in</span> <span class="n">direction</span> <span class="ow">or</span> <span class="s1">&#39;both&#39;</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">elem</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Model.filter_relationships">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.filter_relationships">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fct</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to find relationhips by providing a callback function with criteria</span>

<span class="sd">        :param fct: callback function</span>
<span class="sd">        :type fct: function</span>
<span class="sd">        :return: list(Relationships)</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">fct</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span></div>


<div class="viewcode-block" id="Model.filter_views">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.filter_views">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_views</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fct</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to find views by providing a callback function with criteria</span>

<span class="sd">        :param fct: callback function</span>
<span class="sd">        :type fct: function</span>
<span class="sd">        :return: list(Views)</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">fct</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span></div>


<div class="viewcode-block" id="Model.find_views">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.find_views">[docs]</a>
    <span class="k">def</span> <span class="nf">find_views</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to find views by name</span>

<span class="sd">        :param name:</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :return: list(View)</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span></div>


<div class="viewcode-block" id="Model.get_or_create_element">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.get_or_create_element">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">create_elem</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get an Element by name or create one if not existing</span>

<span class="sd">        :param elem_type:   Archimate type of the element</span>
<span class="sd">        :type elem_type: str</span>
<span class="sd">        :param elem:        name of the Element</span>
<span class="sd">        :type elem: str</span>
<span class="sd">        :param create_elem: if True,  create a new Element if not found</span>
<span class="sd">        :type create_elem: bool</span>
<span class="sd">        :return: Element object</span>
<span class="sd">        :rtype: Element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">create_elem</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">elem</span><span class="p">,</span> <span class="n">concept_type</span><span class="o">=</span><span class="n">elem_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Model.get_or_create_relationship">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.get_or_create_relationship">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_relationship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">create_rel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">access_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">influence_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get a Relationship by source/target/type and/or by name or create one if not found</span>

<span class="sd">        :param rel_type:                Archimate type of the relationship</span>
<span class="sd">        :type rel_type: str</span>
<span class="sd">        :param name:                    name of the relationships</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param source:                  Source Element or Identifier of the Element</span>
<span class="sd">        :type source: [str|Element]</span>
<span class="sd">        :param target:                  Target Element or Identifier of the Element</span>
<span class="sd">        :type target: [str|Element]</span>
<span class="sd">        :param create_rel:              if True, create a new relationship if not found</span>
<span class="sd">        :type create_rel: bool</span>
<span class="sd">        :param access_type:             if type is Access, and creat_rel is true, set the access type</span>
<span class="sd">        :type access_type: str</span>
<span class="sd">        :param influence_strength:      if type is Influence, and creat_rel is true, set the strenght</span>
<span class="sd">        :type influence_strength: str</span>
<span class="sd">        :param desc:                    relationship description</span>
<span class="sd">        :type desc: str</span>
<span class="sd">        :param is_directed:             if type is Association, and creat_rel is true, set the direction flag</span>
<span class="sd">        :type is_directed: bool</span>
<span class="sd">        :return:                        Relationship object</span>
<span class="sd">        :rtype: Relationship</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Relations are created between Elements, not Nodes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">concept</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">concept</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">access_type</span> <span class="o">==</span> <span class="n">access_type</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">is_directed</span> <span class="o">==</span> <span class="n">is_directed</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_relationships</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">rel_type</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">source</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">uuid</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">access_type</span> <span class="o">==</span> <span class="n">access_type</span>
                                                     <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">is_directed</span> <span class="o">==</span> <span class="n">is_directed</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">create_rel</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_relationship</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">rel_type</span><span class="o">=</span><span class="n">rel_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                         <span class="n">access_type</span><span class="o">=</span><span class="n">access_type</span><span class="p">,</span> <span class="n">influence_strength</span><span class="o">=</span><span class="n">influence_strength</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                                         <span class="n">is_directed</span><span class="o">=</span><span class="n">is_directed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Model.get_or_create_view">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.get_or_create_view">[docs]</a>
    <span class="k">def</span> <span class="nf">get_or_create_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">create_view</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get or create a view by name</span>

<span class="sd">        :param view:        View name</span>
<span class="sd">        :type view: str</span>
<span class="sd">        :param create_view: if True, create a view if not found</span>
<span class="sd">        :type create_view: bool</span>
<span class="sd">        :return:            View object</span>
<span class="sd">        :rtype: View</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_views</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">create_view</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ArchiType</span><span class="o">.</span><span class="n">View</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">view</span>
        <span class="k">return</span> <span class="n">v</span></div>


<div class="viewcode-block" id="Model.embed_props">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.embed_props">[docs]</a>
    <span class="k">def</span> <span class="nf">embed_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_props</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to embed properties of each view, element, relationship into their description attribute</span>
<span class="sd">        as a stringified json tag</span>

<span class="sd">        Some tools like Aris are not configured to managed concept&#39;s properties,</span>
<span class="sd">        so we embed the properties before exporting the model there</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Local function to embed the properties of an object</span>

<span class="sd">            :param o:   Method/View/Element/Relationship object</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
                <span class="c1"># For relationship, we embed all properties in a single one called &#39;Identifier&#39;</span>
                <span class="c1"># to cope with ARIS limitation</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">o</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="s1">&#39;Identifier&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="c1"># if o.desc is not None:</span>
                <span class="c1">#     p[&#39;documentation&#39;] = o.desc</span>
                <span class="c1"># if o.type == ArchiType.Association:</span>
                <span class="c1">#     p[&#39;isDirected&#39;] = o.is_directed</span>
                <span class="c1"># elif o.type == ArchiType.Access:</span>
                <span class="c1">#     p[&#39;access&#39;] = o.access_type</span>
                <span class="c1"># elif o.type == ArchiType.Influence:</span>
                <span class="c1">#     p[&#39;influence_strength&#39;] = o.influence_strength</span>
                <span class="c1"># for key, val in o.props.items():</span>
                <span class="c1">#     p[key] = val</span>
                <span class="c1"># o.prop(&#39;Identifier&#39;, o.name)</span>

            <span class="k">elif</span> <span class="n">o</span><span class="o">.</span><span class="n">props</span> <span class="o">!=</span> <span class="p">{}</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Model</span><span class="p">)):</span>
                <span class="c1"># Else we embed properties art the end of the description field</span>
                <span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[#]*properties\s*=\s*(\{[\s\S]*\})[;]*&#39;</span>
                <span class="c1"># Get the concept description and remove any existing embedded properties tag</span>
                <span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
                <span class="c1"># add the properties tag in the concept desc</span>
                <span class="n">desc</span> <span class="o">+=</span> <span class="n">desc</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">properties = &#39;</span> <span class="o">+</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">props</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
                <span class="k">if</span> <span class="n">remove_props</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>
                        <span class="n">o</span><span class="o">.</span><span class="n">remove_prop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_embed</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_embed</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_embed</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.expand_props">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.expand_props">[docs]</a>
    <span class="k">def</span> <span class="nf">expand_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clean_doc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to expand model&#39;s concepts desc attribute properties tag into concept&#39;s properties</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_expand</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">clean_doc</span><span class="p">):</span>
            <span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[#]*properties\s*=\s*(\{[\s\S]*\})[;]*&#39;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="s1">&#39;Identifier&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="s1">&#39;Identifier&#39;</span><span class="p">)</span>
                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">o</span><span class="o">.</span><span class="n">remove_prop</span><span class="p">(</span><span class="s1">&#39;Identifier&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">else</span> <span class="kc">None</span>
                            <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;documentation&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;documentation&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">else</span> <span class="kc">None</span>
                            <span class="k">if</span> <span class="s1">&#39;isDirected&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Association</span><span class="p">:</span>
                                <span class="n">o</span><span class="o">.</span><span class="n">is_directed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;isDirected&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span> <span class="k">else</span> <span class="kc">False</span>
                            <span class="k">if</span> <span class="s1">&#39;access&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Access</span><span class="p">:</span>
                                <span class="n">o</span><span class="o">.</span><span class="n">access_type</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;access&#39;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="s1">&#39;influence_strength&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ArchiType</span><span class="o">.</span><span class="n">Influence</span><span class="p">:</span>
                                <span class="n">o</span><span class="o">.</span><span class="n">influence_strength</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;influence_strength&#39;</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                <span class="n">o</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">clean_doc</span><span class="p">:</span>
                    <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
                <span class="c1"># Get the concept description and remove any existing embedded properties tag</span>
                <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1"># get the properties</span>
                        <span class="n">props</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="c1"># and clean up the desc attribute</span>
                        <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">o</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">clean_doc</span><span class="p">:</span>
                            <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>

        <span class="n">_expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clean_doc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">views_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_expand</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">clean_doc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_expand</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">clean_doc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_expand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">clean_doc</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.check_invalid_conn">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.check_invalid_conn">[docs]</a>
    <span class="k">def</span> <span class="nf">check_invalid_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to check the validity of a list of connections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">invalids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conns_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_connection</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                <span class="n">invalids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">invalids</span></div>


<div class="viewcode-block" id="Model.check_connection">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.check_connection">[docs]</a>
    <span class="k">def</span> <span class="nf">check_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to check the validity of a single connection</span>

<span class="sd">        :param c:   Connection object</span>
<span class="sd">        :type c:    Connection</span>
<span class="sd">        :return:    True if the connection is valid</span>
<span class="sd">        :rtype:     boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_ok</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># check connections with unknown references</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rels_dict</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Orphan connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> to unknown relationship </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">ref</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># check existence of the source &amp; target nodes</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has orphan source node </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">_source</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has orphan source node concept </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_source</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has orphan target node </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">_target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has orphan target node concept </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Check source / target are nodes, not views</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">View</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has a view </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> as source node&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">View</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has a view </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> as source node&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">_ref</span> <span class="o">!=</span> <span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_source</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has a reference to its source Element which is not &#39;</span>
                          <span class="s1">&#39;the reference of the relationship source Element&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">_ref</span> <span class="o">!=</span> <span class="n">c</span><span class="o">.</span><span class="n">concept</span><span class="o">.</span><span class="n">_target</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Connection </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> has a reference to its target Element which is not &#39;</span>
                          <span class="s1">&#39;the reference of the relationship target Element&#39;</span><span class="p">)</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">_ok</span></div>


<div class="viewcode-block" id="Model.check_invalid_nodes">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.check_invalid_nodes">[docs]</a>
    <span class="k">def</span> <span class="nf">check_invalid_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check and get the list of nodes that are orphans (without known related Element)</span>
<span class="sd">        :return: list of orphan nodes</span>
<span class="sd">        :rtype: list(Node)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">invalids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems_dict</span> <span class="ow">and</span> <span class="n">n</span><span class="o">.</span><span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Element&#39;</span><span class="p">:</span>
                <span class="n">invalids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Orphan node &quot;</span><span class="si">{</span><span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; with id </span><span class="si">{</span><span class="n">n</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1"> refers to unknown </span><span class="si">{</span><span class="n">n</span><span class="o">.</span><span class="n">ref</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">ArchimateConceptTypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Orphan node with id </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">invalids</span></div>


<div class="viewcode-block" id="Model.default_theme">
<a class="viewcode-back" href="../pyArchimate.html#pyArchimate.Model.default_theme">[docs]</a>
    <span class="k">def</span> <span class="nf">default_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">default_theme</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the default color theme for the model</span>
<span class="sd">        :param theme: default theme reference</span>
<span class="sd">        :return: nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">default_color</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">theme</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conns</span><span class="p">:</span>
            <span class="n">r</span><span class="o">.</span><span class="n">line_color</span> <span class="o">=</span> <span class="n">default_color</span><span class="p">(</span><span class="s1">&#39;Relationship&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_theme</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span></div>
</div>


<span class="c1"># Library initialization code</span>
<span class="c1"># Fetch model parameters during initialization of the module</span>
<span class="k">if</span> <span class="n">allowed_relationships</span> <span class="o">==</span> <span class="p">{}:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">__location__</span><span class="p">,</span> <span class="s2">&quot;checker_rules.yml&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">Loader</span><span class="p">)</span>
        <span class="n">allowed_relationships</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;archimate_rels&#39;</span><span class="p">]</span>
        <span class="n">ARIS_type_map</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ARIS_type_map&#39;</span><span class="p">]</span>
        <span class="n">relationship_keys</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;relationship_keys&#39;</span><span class="p">]</span>
        <span class="n">archi_category</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;archi_category&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="fm">__mod__</span><span class="si">}</span><span class="s1">: Cannot open metamodel parameters - checks are disabled!</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="fm">__mod__</span><span class="si">}</span><span class="s1">: Invalid metamodel parameters - checks are disabled!&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ING Bank Belgium.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>